language : cpp
dist: trusty
env:
  - DISPLAY=:99.0 
addons:
compiler:
before_install:
    - npm install -g mocha allure-commandline
    - openssl aes-256-cbc -K $encrypted_33bab58a9e7d_key -iv $encrypted_33bab58a9e7d_iv -in deploy_key.enc -out .travis/deploy_key -d
script:
    - git clone https://github.com/benlau/qtbugstatus.git
    - (cd qtbugstatus; npm install)
    - mocha qtbugstatus/runner.js
    - allure generate allure-results --clean -o allure-report
    - ls
    - eval `ssh-agent -s`
    - ssh-add deploy_key
    - (cd allure-report; ../qtbugstatus/deploy_pages.sh)
    
